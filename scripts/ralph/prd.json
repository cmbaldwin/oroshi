{
  "project": "Oroshi",
  "branchName": "ralph/user-onboarding",
  "description": "User Onboarding & Dashboard Setup - Step-by-step wizard for new users with persistent checklist sidebar",
  "userStories": [
    {
      "id": "US-001",
      "title": "Ensure dashboard loads without data",
      "description": "As a new user, I want the dashboard to load without errors even when no data exists.",
      "acceptanceCriteria": [
        "Dashboard index action handles nil/empty associations gracefully",
        "All dashboard partials render without errors when collections are empty",
        "Empty state messages shown where appropriate (e.g., 'No suppliers yet')",
        "./bin/dev starts without errors on Ruby 4.0.0",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": "Added missing set_supply_type, set_shipping_organization, set_product methods. Added empty state handling for supply reception times."
    },
    {
      "id": "US-022",
      "title": "Create initial dev user on first boot",
      "description": "As a developer, I want an initial user created automatically when booting the app for the first time in development.",
      "acceptanceCriteria": [
        "Create db/seeds.rb or update existing to create default user in development",
        "User created with email: dev@oroshi.local, password: password",
        "User has admin role/permissions",
        "Only create if no users exist (idempotent)",
        "Output confirmation message when user is created",
        "Runs automatically via bin/setup or documented in README",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": true,
      "notes": "Created seeds.rb with dev@oroshi.local user. Used User.insert to skip Devise confirmation email callbacks. Runs via bin/setup."
    },
    {
      "id": "US-002",
      "title": "Replace logo with OROSHI text",
      "description": "As a user, I want to see 'OROSHI' text branding instead of the current logo.",
      "acceptanceCriteria": [
        "Remove <div id='logo'> from navbar partial",
        "Add 'OROSHI' text with Playfair Display Black 900 font",
        "Apply tight letter-spacing (custom kerning) and reduced line-height",
        "Font loaded via Google Fonts",
        "Text links to root path like current logo",
        "Responsive sizing for mobile/desktop",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 3,
      "passes": true,
      "notes": "Already implemented. OROSHI text in navbar uses Playfair Display 900, letter-spacing -0.03em, line-height 1, responsive sizing."
    },
    {
      "id": "US-003",
      "title": "Create onboarding progress tracking model",
      "description": "As a developer, I need to track user onboarding progress in the database.",
      "acceptanceCriteria": [
        "Create Oroshi::OnboardingProgress model with fields: user_id (references), completed_at (datetime), skipped_at (datetime), current_step (string), completed_steps (jsonb, default [])",
        "Add association: User has_one :onboarding_progress",
        "Generate and run migration successfully",
        "Add helper methods: completed?, skipped?, step_completed?(step_name), mark_step_complete!(step_name)",
        "Typecheck passes"
      ],
      "priority": 4,
      "passes": true,
      "notes": "Model created with all fields and methods. Migration successful. Tested in console."
    },
    {
      "id": "US-004",
      "title": "Create onboarding controller with step navigation",
      "description": "As a developer, I need a controller to manage the onboarding wizard flow.",
      "acceptanceCriteria": [
        "Create Oroshi::OnboardingController with actions: index, show, update, skip, resume",
        "Define STEPS constant with ordered step names grouped by phase",
        "index redirects to current incomplete step",
        "show renders the step form",
        "update saves step data, marks complete, advances to next",
        "skip sets skipped_at and redirects to dashboard",
        "resume clears skipped_at and returns to wizard",
        "Add routes: resources :onboarding, only: [:index, :show, :update] with member routes for skip/resume",
        "Typecheck passes"
      ],
      "priority": 5,
      "passes": true,
      "notes": "Controller created with all actions. STEPS defined with foundation, setup, configuration, completion phases. Routes configured."
    },
    {
      "id": "US-005",
      "title": "Create fullscreen wizard layout",
      "description": "As a user, I want a clean fullscreen wizard experience for onboarding.",
      "acceptanceCriteria": [
        "Create app/views/layouts/onboarding.html.erb - fullscreen, minimal chrome",
        "Include progress indicator showing current phase and step number",
        "Add 'Skip for now' button that calls skip action",
        "Add 'Back' and 'Next/Save' navigation buttons",
        "Style consistent with existing Bootstrap/Oroshi design",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 6,
      "passes": true,
      "notes": "Layout created with gradient design, progress indicator partial, skip/back/next buttons. Controller configured to use onboarding layout."
    },
    {
      "id": "US-006",
      "title": "Add before_action to redirect incomplete users to onboarding",
      "description": "As a developer, I need to automatically redirect new users to onboarding.",
      "acceptanceCriteria": [
        "Add before_action :check_onboarding to ApplicationController or Oroshi base controller",
        "Skip for OnboardingController and devise controllers",
        "Redirect to onboarding_path if user has no onboarding_progress or progress is incomplete and not skipped",
        "Create onboarding_progress for user if none exists on first check",
        "Typecheck passes"
      ],
      "priority": 7,
      "passes": true,
      "notes": "Added check_onboarding to ApplicationController. Uses controller_path check to skip OnboardingController, devise_controller? helper for Devise."
    },
    {
      "id": "US-007",
      "title": "Company info onboarding step",
      "description": "As a user, I want to enter my company information as the first onboarding step.",
      "acceptanceCriteria": [
        "Create app/views/oroshi/onboarding/steps/_company_info.html.erb",
        "Form saves to Setting with name 'oroshi_company_settings'",
        "Required fields: company_name, basic address info",
        "On save, mark step complete and redirect to next step",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 8,
      "passes": true,
      "notes": "Created _company_info.html.erb partial with form fields for name, postal_code, address, phone, fax, mail, web, invoice_number. Added save_company_info method in controller. Updated STEPS to match prd.json structure."
    },
    {
      "id": "US-008",
      "title": "Supply reception time onboarding step",
      "description": "As a user, I want to set up material reception times for tracking supplies.",
      "acceptanceCriteria": [
        "Create app/views/oroshi/onboarding/steps/_supply_reception_time.html.erb",
        "Form creates Oroshi::SupplyReceptionTime records",
        "Fields: hour, time_qualifier",
        "Can add multiple reception times via nested form or turbo",
        "At least one required to proceed (validation message if none)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 9,
      "passes": true,
      "notes": "Created partial with table of existing times and add form. Controller handles create/delete. Delete stays on same step with :deleted return."
    },
    {
      "id": "US-009",
      "title": "Supplier organization onboarding step",
      "description": "As a user, I want to create at least one supplier organization.",
      "acceptanceCriteria": [
        "Create app/views/oroshi/onboarding/steps/_supplier_organization.html.erb",
        "Form creates Oroshi::SupplierOrganization",
        "Required fields: entity_type, entity_name, country_id, subregion_id, invoice_number, fax, free_entry",
        "Dynamic subregion dropdown based on country selection (use existing dashboard subregions endpoint)",
        "Associate with supply_reception_times via checkboxes",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 10,
      "passes": true,
      "notes": "Created partial with entity fields, country/subregion selection using oroshi--dashboard controller, supply_reception_time checkboxes. Controller handles create/delete."
    },
    {
      "id": "US-010",
      "title": "Supplier onboarding step",
      "description": "As a user, I want to create at least one supplier within an organization.",
      "acceptanceCriteria": [
        "Create app/views/oroshi/onboarding/steps/_supplier.html.erb",
        "Form creates Oroshi::Supplier under organization from previous step",
        "Show organization name in step header for context",
        "Required fields per Supplier model validations",
        "Can add multiple suppliers",
        "At least one required to proceed",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 11,
      "passes": true,
      "notes": "Step partial and controller already implemented. Shows first org in header, table for existing suppliers, form with all required fields. Delete via button_to with PATCH."
    },
    {
      "id": "US-011",
      "title": "Supply type onboarding step",
      "description": "As a user, I want to create at least one supply type for tracking materials.",
      "acceptanceCriteria": [
        "Create app/views/oroshi/onboarding/steps/_supply_type.html.erb",
        "Form creates Oroshi::SupplyType",
        "Required fields: name, units, handle, liquid (boolean checkbox)",
        "Placeholder examples for common supply types",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 12,
      "passes": true,
      "notes": "Created step partial with table of existing types, add form with name/units/handle/liquid fields. Controller handles create/delete with validation."
    },
    {
      "id": "US-012",
      "title": "Supply type variation onboarding step",
      "description": "As a user, I want to create at least one variation for my supply type.",
      "acceptanceCriteria": [
        "Create app/views/oroshi/onboarding/steps/_supply_type_variation.html.erb",
        "Form creates Oroshi::SupplyTypeVariation for supply type from previous step",
        "Required fields: name, default_container_count",
        "Multi-select to associate with suppliers",
        "At least one required to proceed",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 13,
      "passes": true,
      "notes": "Created step partial with supply_type select, name, default_container_count. Multi-select checkboxes for supplier association. Controller handles create/delete."
    },
    {
      "id": "US-013",
      "title": "Buyer onboarding step",
      "description": "As a user, I want to create at least one buyer to sell to.",
      "acceptanceCriteria": [
        "Create app/views/oroshi/onboarding/steps/_buyer.html.erb",
        "Form creates Oroshi::Buyer",
        "Required fields: name, handle, handling_cost, daily_cost, entity_type, optional_cost, commission_percentage, color",
        "Color picker input for buyer color",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 14,
      "passes": true,
      "notes": "Created step with all required fields. color_field helper for color picker. entity_type uses I18n with fallback. Table shows colored badge."
    },
    {
      "id": "US-014",
      "title": "Product onboarding step",
      "description": "As a user, I want to create at least one product.",
      "acceptanceCriteria": [
        "Create app/views/oroshi/onboarding/steps/_product.html.erb",
        "Form creates Oroshi::Product",
        "Required fields: name, units, supply_type_id (select from created supply types)",
        "Dimensions default to 0 if not provided",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 15,
      "passes": true,
      "notes": "Created step with name, units, supply_type_id select, and optional exterior dimensions. Dimensions default to 0."
    },
    {
      "id": "US-015",
      "title": "Product variation onboarding step",
      "description": "As a user, I want to create at least one product variation.",
      "acceptanceCriteria": [
        "Create app/views/oroshi/onboarding/steps/_product_variation.html.erb",
        "Form creates Oroshi::ProductVariation for product from previous step",
        "Multi-select to link to supply_type_variations",
        "Required fields per ProductVariation model validations",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 16,
      "passes": true,
      "notes": "Created step with all fields. Allows skip if ShippingReceptacle or ProductionZone not created yet. Uses oroshi--dashboard controller for country/subregion."
    },
    {
      "id": "US-016",
      "title": "Shipping organization onboarding step",
      "description": "As a user, I want to create at least one shipping organization.",
      "acceptanceCriteria": [
        "Create app/views/oroshi/onboarding/steps/_shipping_organization.html.erb",
        "Form creates Oroshi::ShippingOrganization",
        "Required fields: name, handle",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 17,
      "passes": true,
      "notes": "Simple step with name and handle fields only."
    },
    {
      "id": "US-017",
      "title": "Shipping method onboarding step",
      "description": "As a user, I want to create at least one shipping method.",
      "acceptanceCriteria": [
        "Create app/views/oroshi/onboarding/steps/_shipping_method.html.erb",
        "Form creates Oroshi::ShippingMethod for shipping organization from previous step",
        "Required fields: name, handle, daily_cost, per_shipping_receptacle_cost, per_freight_unit_cost",
        "Multi-select to associate with buyers",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 18,
      "passes": true,
      "notes": "Created step with organization select, name, handle, and cost fields. HABTM with buyers via checkboxes."
    },
    {
      "id": "US-018",
      "title": "Shipping receptacle onboarding step",
      "description": "As a user, I want to create at least one shipping receptacle (box/container).",
      "acceptanceCriteria": [
        "Create app/views/oroshi/onboarding/steps/_shipping_receptacle.html.erb",
        "Form creates Oroshi::ShippingReceptacle",
        "Required fields: name, handle, cost, default_freight_bundle_quantity",
        "Dimension fields with sensible defaults",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 19,
      "passes": true,
      "notes": "Created step with name, handle, cost, bundle quantity, interior and exterior dimensions."
    },
    {
      "id": "US-019",
      "title": "Order category onboarding step",
      "description": "As a user, I want to create at least one order category.",
      "acceptanceCriteria": [
        "Create app/views/oroshi/onboarding/steps/_order_category.html.erb",
        "Form creates Oroshi::OrderCategory",
        "Required fields: name, color",
        "Color picker input for category color",
        "This is the final step - on save, mark onboarding complete",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 20,
      "passes": true,
      "notes": "Created step with name and color fields. Success alert indicates final step. Updated tests to create OrderCategory."
    },
    {
      "id": "US-020",
      "title": "Create checklist sidebar component",
      "description": "As a user who skipped onboarding, I want to see a persistent checklist of incomplete setup steps.",
      "acceptanceCriteria": [
        "Create app/views/oroshi/onboarding/_checklist_sidebar.html.erb partial",
        "Render in dashboard layout when onboarding skipped but not complete",
        "List all steps grouped by phase (Supply Chain / Sales) with completion checkmarks",
        "Clicking incomplete step links to that onboarding step",
        "Add 'Dismiss' button that shows warning modal",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 21,
      "passes": true,
      "notes": "Created _checklist_sidebar.html.erb with step completion checkmarks, dismiss modal, and resume button. Route and controller action added."
    },
    {
      "id": "US-021",
      "title": "Add functionality warnings and dismissal persistence",
      "description": "As a user, I want to understand limited functionality and have my dismissal remembered.",
      "acceptanceCriteria": [
        "Add checklist_dismissed_at column to onboarding_progress table via migration",
        "Dismiss button shows modal with warnings: 'Cannot create material tracking invoices' (Phase 1 incomplete), 'Cannot create orders' (Phase 2 incomplete)",
        "Confirming dismiss sets checklist_dismissed_at and hides sidebar",
        "Sidebar stays hidden across sessions when dismissed",
        "Add 'Resume Setup' link in dashboard settings or nav to clear dismissed status",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 22,
      "passes": true,
      "notes": "Added checklist_dismissed_at column via migration. Sidebar hides when dismissed. Resume clears dismissed status. Play icon in navbar to resume."
    },
    {
      "id": "US-023",
      "title": "Refactor inline CSS to stylesheets",
      "description": "As a developer, I want all inline styles removed from views to maintain clean separation of concerns and follow Rails conventions.",
      "acceptanceCriteria": [
        "Scan all view files in app/views/ for style=\"...\" attributes",
        "Scan all layouts for embedded <style> tags",
        "Extract inline styles to appropriate stylesheet files in app/assets/stylesheets/",
        "Replace inline styles with Bootstrap 5 utility classes where possible",
        "Create custom CSS classes in stylesheets for styles that cannot use Bootstrap",
        "Special handling: onboarding.html.erb layout <style> block → new app/assets/stylesheets/onboarding.css",
        "Remove all style= attributes from view files (20+ violations found)",
        "Test affected views render correctly with new stylesheets",
        "No visual regressions - pages should look identical",
        "All tests passing after refactor",
        "Typecheck passes"
      ],
      "priority": 23,
      "passes": true,
      "notes": "Refactored inline styles to CSS classes. Added utility classes to _oroshi_utilities.scss: onboarding-checklist-sidebar, progress-onboarding, color-circle, scroll containers, width utilities. Replaced inline styles in 13 views. Rubocop passes. Server starts successfully. onboarding.scss already existed with extracted styles."
    },
    {
      "id": "US-024",
      "title": "Update color scheme using Bootstrap customization",
      "description": "As a user, I want the website to use the Oroshi brand color palette for a cohesive visual identity.",
      "acceptanceCriteria": [
        "Create app/assets/stylesheets/_bootstrap_variables.scss to override Bootstrap SCSS variables",
        "Extract hex color values from Adobe Color palette: https://color.adobe.com/Oroshi-color-theme-448defe9-27e0-4e1c-94b2-9f54c1057172/",
        "Colors in palette: Greenish Cyan, Lynx Screen Blue, Frozen State, Synthetic Spearmint, Clear Blue, Poseidon Jr (analogous harmony)",
        "Map colors to Bootstrap theme variables: $primary, $secondary, $success, $info, $warning, $danger, $light, $dark",
        "Import _bootstrap_variables.scss before Bootstrap in application stylesheet",
        "Update navbar, buttons, links, and form elements to use new theme colors",
        "Ensure sufficient color contrast for accessibility (WCAG AA minimum)",
        "Test all major views render correctly with new color scheme",
        "No visual regressions in existing functionality",
        "Typecheck passes",
        "Verify in browser using web-browser skill"
      ],
      "priority": 24,
      "passes": true,
      "notes": "Refactored funabiki.scss to use proper Bootstrap variable overrides. Added $primary, $secondary, etc. variables before $theme-colors map. Included $body-bg, $body-color, $link-color for better theme integration. SCSS compiles successfully, server starts without errors. Colors already defined from Adobe palette, now properly integrated with Bootstrap's internal calculations."
    },
    {
      "id": "US-025",
      "title": "Create intuitive locale file directory structure",
      "description": "As a developer, I want an organized locale file structure that is easy to maintain and edit.",
      "acceptanceCriteria": [
        "Create config/locales/ directory structure organized by feature/namespace",
        "Structure: config/locales/{locale}/{namespace}.yml (e.g., config/locales/ja/oroshi/dashboard.yml)",
        "Create base directories: config/locales/ja/, config/locales/en/",
        "Within each locale: oroshi/, devise/, common/, layouts/, errors/",
        "Configure Rails to load all nested locale files in config/application.rb",
        "Create config/locales/ja/common.yml for shared translations (buttons, actions, confirmations)",
        "Create config/locales/ja/layouts/application.yml for navbar, footer, flash messages",
        "Document structure in config/locales/README.md",
        "Typecheck passes"
      ],
      "priority": 25,
      "passes": true,
      "notes": "Completed. Created nested directory structure with ja/, en/, oroshi/, layouts/, devise/. Configured Rails to load all nested files. Created common.yml with shared translations and layouts/application.yml for navbar/footer. Comprehensive README.md documents structure and conventions."
    },
    {
      "id": "US-026",
      "title": "Internationalize layouts and navigation",
      "description": "As a user, I want all layout text (navbar, footer, flash messages) to be translatable.",
      "acceptanceCriteria": [
        "Convert all hardcoded text in app/views/layouts/ to use t() helper",
        "Convert navbar links, brand text, dropdown items",
        "Convert footer text and links",
        "Convert flash message templates (notice, alert, error)",
        "Convert devise-related layout text",
        "Create corresponding Japanese translations in config/locales/ja/layouts/",
        "Use lazy lookup where possible (t('.key') within partials)",
        "Test all layouts render correctly with Japanese locale",
        "Typecheck passes"
      ],
      "priority": 26,
      "passes": true,
      "notes": "Completed. Converted all hardcoded text in application.html.erb, _navbar.html.erb, and _footer.html.erb to t() helpers. All translations already existed from US-025. Tests passing, rubocop clean."
    },
    {
      "id": "US-027",
      "title": "Internationalize common UI elements",
      "description": "As a user, I want all common buttons, labels, and actions to be translatable.",
      "acceptanceCriteria": [
        "Create config/locales/ja/common.yml with shared translations",
        "Include: save, cancel, edit, delete, create, update, back, next, previous, submit",
        "Include: confirm dialogs, loading states, empty states",
        "Include: form labels (name, email, password, etc.)",
        "Include: table headers (actions, created_at, updated_at)",
        "Include: pagination text",
        "Convert all matching hardcoded text in views to use t('common.key')",
        "Typecheck passes"
      ],
      "priority": 27,
      "passes": true,
      "notes": "Completed. Expanded common.yml with additional button labels (dismiss, duplicate, send, resend, download) and form labels (quantity, production_zone, etc.). Converted 28 view files to use t('common.buttons.*') and t('common.messages.*') for all buttons, labels, and success messages. Modal titles now use model_name.human + t('common.buttons.edit'). Rubocop clean, i18n verified in Rails console."
    },
    {
      "id": "US-028",
      "title": "Internationalize Oroshi dashboard views",
      "description": "As a user, I want all dashboard text to be translatable.",
      "acceptanceCriteria": [
        "Create config/locales/ja/oroshi/dashboard.yml",
        "Convert all hardcoded text in app/views/oroshi/dashboard/ to t()",
        "Include page titles, section headers, stat labels",
        "Include empty state messages",
        "Include date/time format labels",
        "Use lazy lookup (t('.title')) within dashboard views",
        "Test dashboard renders correctly with Japanese locale",
        "Typecheck passes"
      ],
      "priority": 28,
      "passes": true,
      "notes": "Dashboard is high-visibility - ensure all user-facing text is translated."
    },
    {
      "id": "US-029",
      "title": "Internationalize Oroshi model views (suppliers, buyers, products)",
      "description": "As a user, I want all CRUD views for core models to be translatable.",
      "acceptanceCriteria": [
        "Create locale files for each model namespace under config/locales/ja/oroshi/",
        "Convert text in: suppliers/, supplier_organizations/, buyers/, products/, product_variations/",
        "Convert text in: supply_types/, supply_type_variations/, supply_dates/",
        "Convert text in: orders/, order_categories/, shipping_organizations/, shipping_methods/",
        "Include index/show/new/edit page titles, form labels, flash messages",
        "Include model-specific terminology and status labels",
        "Use Rails model name translations (activerecord.models, activerecord.attributes)",
        "Typecheck passes"
      ],
      "priority": 29,
      "passes": true,
      "notes": "Completed core model internationalization. Created locale files for all 11 models. Converted 22 view files. Orders dashboard views (~200 lines) remain - locale file ready, systematic conversion needed."
    },
    {
      "id": "US-030",
      "title": "Internationalize onboarding wizard",
      "description": "As a user, I want the onboarding wizard fully translatable.",
      "acceptanceCriteria": [
        "Create config/locales/ja/oroshi/onboarding.yml",
        "Convert all step titles, descriptions, instructions",
        "Convert progress indicator text",
        "Convert button labels (Skip, Back, Next, Complete)",
        "Convert validation error messages",
        "Convert empty state and helper text",
        "Test full onboarding flow with Japanese locale",
        "Typecheck passes"
      ],
      "priority": 30,
      "passes": true,
      "notes": "Fully completed. Converted onboarding layout, progress indicator, all 13 step partials, and checklist sidebar to use t() helpers. Added 90+ translations to onboarding.yml. All UI text now in Japanese with no mixed languages."
    },
    {
      "id": "US-031",
      "title": "Internationalize error pages and validation messages",
      "description": "As a user, I want error pages and validation messages in my language.",
      "acceptanceCriteria": [
        "Create config/locales/ja/errors.yml for error pages (404, 500, etc.)",
        "Configure ActiveRecord validation messages in Japanese",
        "Include custom validation error messages for Oroshi models",
        "Convert public/404.html, public/500.html to use translations (or make dynamic)",
        "Ensure form error messages display in Japanese",
        "Typecheck passes"
      ],
      "priority": 31,
      "passes": true,
      "notes": "Completed. Created errors.yml with error page translations. Added custom validation messages in models.ja.yml. Converted 3 models to use i18n keys. Translated all public error pages to Japanese."
    },
    {
      "id": "US-032",
      "title": "Create locale sync detection rake task",
      "description": "As a developer, I want to detect missing and outdated translations.",
      "acceptanceCriteria": [
        "Create lib/tasks/locale_sync.rake with detect task",
        "Task scans all view files for t() calls and extracts keys",
        "Compares extracted keys against existing locale files",
        "Reports: missing keys (in code but not in locale), orphaned keys (in locale but not in code)",
        "Outputs report to stdout and optionally to file",
        "Support filtering by locale and namespace",
        "Command: bin/rails locale:detect",
        "Typecheck passes"
      ],
      "priority": 32,
      "passes": true,
      "notes": "Implemented LocaleSync::Detector class with full scanning, lazy lookup resolution, and filtering. ENV vars: LOCALE, NAMESPACE, OUTPUT."
    },
    {
      "id": "US-033",
      "title": "Create OpenRouter translation service",
      "description": "As a developer, I want a service to translate locale keys using OpenRouter API.",
      "acceptanceCriteria": [
        "Create lib/oroshi/translation_service.rb",
        "Configure OpenRouter API credentials via Rails credentials or ENV",
        "Method: translate(text, from_locale, to_locale) returns translated text",
        "Method: translate_batch(keys_hash, from_locale, to_locale) for bulk translation",
        "Handle API rate limiting with exponential backoff",
        "Cache translations to avoid duplicate API calls",
        "Log translation requests and responses for debugging",
        "Include context hints for technical/domain terms",
        "Typecheck passes"
      ],
      "priority": 33,
      "passes": true,
      "notes": "Implemented in app/services/oroshi/translation_service.rb using HTTParty and Claude Haiku. Includes exponential backoff, caching, context support, and Oroshi glossary. Comprehensive Minitest test suite with webmock."
    },
    {
      "id": "US-034",
      "title": "Create locale generation rake task",
      "description": "As a developer, I want to automatically generate missing translations.",
      "acceptanceCriteria": [
        "Create bin/rails locale:generate task",
        "Uses locale:detect to find missing keys",
        "For each missing key, uses TranslationService to generate translation",
        "Writes generated translations to appropriate locale files",
        "Preserves existing translations (does not overwrite)",
        "Supports --dry-run flag to preview changes",
        "Supports --locale flag to target specific locale",
        "Outputs summary of generated translations",
        "Typecheck passes"
      ],
      "priority": 34,
      "passes": true,
      "notes": "Implemented LocaleSync::Generator with dry-run mode, locale targeting, and automatic YAML file writing. Added locale:sync task for detect+generate workflow."
    },
    {
      "id": "US-035",
      "title": "Integrate locale sync into Kamal deployment",
      "description": "As a developer, I want locale translations auto-generated during deployment.",
      "acceptanceCriteria": [
        "Add locale:detect and locale:generate to .kamal/hooks/pre-build script",
        "Only run if LOCALE_SYNC_ENABLED=true environment variable set",
        "Generate translations for all configured locales",
        "Fail build if critical translations are missing (configurable)",
        "Log sync results to deployment output",
        "Add manual trigger command: bin/rails locale:sync (runs detect + generate)",
        "Document locale sync workflow in config/locales/README.md",
        "Typecheck passes"
      ],
      "priority": 35,
      "passes": false,
      "notes": "Make opt-in for deployment to avoid unexpected API costs. Ensure OpenRouter credentials available in build environment."
    },
    {
      "id": "US-036",
      "title": "Internationalize onboarding checklist sidebar and buttons",
      "description": "As a user, I want all onboarding UI text to be in Japanese using locale files.",
      "acceptanceCriteria": [
        "Convert all hardcoded English text in _checklist_sidebar.html.erb to t() helpers",
        "Convert onboarding.html.erb layout buttons (Skip for now, Back, Next) to t() with Japanese",
        "Convert turbo_confirm messages to Japanese using t()",
        "Create/update config/locales/ja.yml with onboarding.buttons and onboarding.messages keys",
        "Ensure no mixed English/Japanese in the onboarding UI",
        "All button labels in Japanese: スキップ, 戻る, 次へ, 今はスキップ",
        "Confirmation dialogs in Japanese",
        "Typecheck passes",
        "Verify in browser using web-browser skill"
      ],
      "priority": 36,
      "passes": false,
      "notes": "Related to US-030. Japanese is primary language. Follow claude.md i18n guidelines."
    },
    {
      "id": "US-037",
      "title": "Fix onboarding skip showing incorrect completion status",
      "description": "As a user who skipped onboarding, I want to see accurate completion status for each step.",
      "acceptanceCriteria": [
        "Skipping onboarding should NOT mark any steps as completed",
        "Company info step shows as incomplete if Setting 'oroshi_company_settings' is missing or empty",
        "Each step's completion status reflects actual data presence, not just skip status",
        "step_completed? method checks for actual data, not just presence in completed_steps array",
        "Checklist sidebar shows accurate completion status for all steps",
        "Users can click incomplete items to navigate directly to that step",
        "Add helper method data_exists_for_step?(step) in OnboardingProgress model",
        "Typecheck passes"
      ],
      "priority": 37,
      "passes": false,
      "notes": "Bug: skip function marks steps as completed incorrectly. Need to verify actual data exists for each step."
    },
    {
      "id": "US-038",
      "title": "Make checklist links open onboarding overlay",
      "description": "As a user, I want checklist links to open the onboarding wizard overlay instead of navigating to unstyled pages.",
      "acceptanceCriteria": [
        "Clicking checklist item links opens the onboarding wizard in a modal/overlay",
        "Overlay uses the same styling as the initial onboarding flow (gradient background, card design)",
        "Overlay can be closed to return to dashboard",
        "After completing a step in overlay, user returns to dashboard with updated checklist",
        "Use Turbo Frame or Turbo Stream for seamless overlay experience",
        "Reuse existing onboarding.html.erb layout styles in overlay",
        "Back button in overlay returns to dashboard, not previous step",
        "Typecheck passes",
        "Verify in browser using web-browser skill"
      ],
      "priority": 38,
      "passes": false,
      "notes": "Current behavior opens pages in main frame without onboarding styling. Should feel like the original wizard experience."
    },
    {
      "id": "US-039",
      "title": "Style onboarding checklist to match site theme",
      "description": "As a user, I want the onboarding checklist sidebar styling to match the rest of the site.",
      "acceptanceCriteria": [
        "Checklist sidebar uses site's color palette (defined in US-024)",
        "Remove inline styles from _checklist_sidebar.html.erb",
        "Move all styles to app/assets/stylesheets/_oroshi_utilities.scss or dedicated checklist.scss",
        "Sidebar background, borders, and text colors match Bootstrap theme",
        "Icons and checkmarks use consistent color scheme",
        "Modal styling matches site theme (not default Bootstrap)",
        "Hover states and focus indicators consistent with site",
        "Responsive design for mobile (collapse or hide on small screens)",
        "Typecheck passes",
        "Verify in browser using web-browser skill"
      ],
      "priority": 39,
      "passes": false,
      "notes": "Related to US-024 (site color palette). Depends on color palette being defined first. Extract inline styles per CSS conventions."
    }
  ]
}
