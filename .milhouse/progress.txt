# Milhouse Progress Log
Started: Fri Feb  7 13:30:00 JST 2026
---

[2026-02-07 13:35:00] Story: US-001 - Fix CSS 404 for ultimate_turbo_modal_bootstrap.css
Implemented: Removed .css extension from @import directive in application.scss
Files: app/assets/stylesheets/application.scss
Tests: PASSING (617 runs, 0 failures, 0 errors)
Learnings for future iterations:
- Propshaft SCSS: @import "file.css" generates a CSS @import url() request (causes 404). Remove the .css extension to embed file contents inline.
- This is a one-line fix with high impact — eliminates persistent console 404 error.

[2026-02-07 14:57:00] Story: US-002 - Fix Bootstrap ScrollSpy import in revenue controller
Implemented: Added explicit Bootstrap ESM import in the revenue Stimulus controller so bootstrap.ScrollSpy resolves in module scope.
Files: app/javascript/controllers/oroshi/orders/revenue_controller.js, .milhouse/prd.json
Tests: PASSING (617 runs, 0 failures, 0 errors)
Learnings for future iterations:
- Stimulus controllers cannot rely on Bootstrap imported in application.js; each controller using bootstrap.* must import bootstrap directly.
- The existing ScrollSpy initialization logic worked once bootstrap was in scope; this story required a minimal targeted JS change.

[2026-02-07 14:59:57] Story: US-003 - Fix order quantity inline editing (注文表 tab)
Implemented: Fixed the order edit form Stimulus submit action binding to use an explicit submit event so inline quantity updates trigger orderFormSubmit and PATCH to quantity_update via fetch.
Files: app/views/oroshi/orders/edit.html.erb, .milhouse/prd.json
Tests: PASSING (617 runs, 0 failures, 0 errors)
Learnings for future iterations:
- Stimulus action bindings on forms must include explicit event syntax (submit->controller#method); omitting the event prevents handler invocation.
- The quantity input change wiring in order_number_field was already correct; the submit action string was the blocking issue for inline save.

[2026-02-07 16:23:16] Story: Fix order price inline editing (単価記載 tab)
Implemented: Updated the order sales form Stimulus wiring so price inputs use the sales-form namespace and submit through the order controller with explicit submit/change events to the price_update endpoint.
Files: app/views/oroshi/orders/dashboard/sales/_order_sales_form.html.erb, .milhouse/prd.json, .milhouse/progress.txt
Tests: PASSING
Learnings for future iterations:
- For nested Turbo-frame forms, attach both controllers on the form when targets/actions span multiple Stimulus namespaces.
- Use explicit submit->... and change->... actions to avoid brittle implicit event behavior in inline edit flows.
